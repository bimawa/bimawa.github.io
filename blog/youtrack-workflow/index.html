<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://bimawa.github.io/style.css">
    <link rel="stylesheet" href="https://bimawa.github.io/color/blue-light.css">

        <link rel="stylesheet" href="https://bimawa.github.io/color/background_dark.css">
    
    <link rel="stylesheet" href="https://bimawa.github.io/font-hack.css">

    <meta name="description" content="A practical guide to creating custom workflow automation rules in JetBrains YouTrack using JavaScript, with real-world examples for enforcing time tracking and state transitions.">

    <meta property="og:description" content="A practical guide to creating custom workflow automation rules in JetBrains YouTrack using JavaScript, with real-world examples for enforcing time tracking and state transitions.">
    <meta property="og:title" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bimawa.github.io/blog/youtrack-workflow/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="A practical guide to creating custom workflow automation rules in JetBrains YouTrack using JavaScript, with real-world examples for enforcing time tracking and state transitions.">
    <meta name="twitter:title" content="">
    <meta property="twitter:domain" content="bimawa.github.io">
    <meta property="twitter:url" content="https://bimawa.github.io/blog/youtrack-workflow/">

        <link rel="shortcut icon" type="image/ico" href="/favicon.ico">
    
    <meta name="description" content="Bimawa's blog"/>
    <meta name="keywords" content="Hacking, Programming, R&D"/>
</head>

<body class="">
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://bimawa.github.io" style="text-decoration: none;">
                    <div class="logo">
                      
                            Bimawa&#x27;s blog
                        
                    </div>
                </a>
            </div>
        </div>

        
        
                <nav class="menu">
            <ul class="menu__inner">
                <li class="active"><a href="https://bimawa.github.io">Blog</a></li>
            
                <li><a href="https://bimawa.github.io/tags">Tags</a></li>
            
                <li><a href="https://bimawa.github.io/archive">Archive</a></li>
            
                <li><a href="https://bimawa.github.io/about">About me</a></li>
            
                <li><a href="https://bimawa.github.io/cv">CV</a></li>
            
                <li><a href="https://bimawa.github.io/contacts">Contacts</a></li>
            </ul>
        </nav>
    
    
        
    </header>
    

    <div class="content">
        
    <div class="post">
        
    <h1 class="post-title"><a href="https://bimawa.github.io/blog/youtrack-workflow/">Automating Project Workflows with YouTrack JavaScript Rules</a></h1>
    <div class="post-meta-inline">
        
    <span class="post-date">
            2025-11-16
        </span>

    </div>

    
        <span class="post-tags-inline">
                :: tags:&nbsp;
                <a class="post-tag" href="https://bimawa.github.io/tags/automation/">#automation</a>&nbsp;
                <a class="post-tag" href="https://bimawa.github.io/tags/javascript/">#javascript</a>&nbsp;
                <a class="post-tag" href="https://bimawa.github.io/tags/project-management/">#project-management</a>&nbsp;
                <a class="post-tag" href="https://bimawa.github.io/tags/workflow/">#workflow</a>&nbsp;
                <a class="post-tag" href="https://bimawa.github.io/tags/youtrack/">#youtrack</a></span>
    

        <div class="post-content">
            <h1 id="introduction">Introduction</h1>
<p>JetBrains YouTrack provides a powerful workflow engine that allows teams to automate and enforce project management policies using JavaScript. Unlike simple status transitions, YouTrack workflows can validate data, enforce business rules, and ensure consistency across your development process.</p>
<p>This article explores practical workflow automation through three real-world examples: validating test environment deployments, enforcing time tracking, and ensuring task estimation. These patterns are applicable to any team using YouTrack for agile development.</p>
<h2 id="why-workflow-automation">Why Workflow Automation?</h2>
<p>Manual enforcement of project policies is error-prone and time-consuming. Common problems include:</p>
<ul>
<li><strong>Incomplete time tracking</strong>: Developers forget to log spent time</li>
<li><strong>Missing estimations</strong>: Tasks move to "In Progress" without effort estimates</li>
<li><strong>Incorrect state transitions</strong>: Test builds deployed to production accidentally</li>
<li><strong>Inconsistent processes</strong>: Different team members follow different workflows</li>
</ul>
<p>YouTrack's JavaScript-based workflows solve these problems by:</p>
<ol>
<li><strong>Preventing invalid transitions</strong>: Block state changes that violate policies</li>
<li><strong>Enforcing required fields</strong>: Ensure critical data is captured</li>
<li><strong>Validating business logic</strong>: Implement complex rules programmatically</li>
<li><strong>Providing immediate feedback</strong>: Show clear error messages to users</li>
</ol>
<span id="continue-reading"></span><h2 id="youtrack-workflow-basics">YouTrack Workflow Basics</h2>
<h3 id="workflow-structure">Workflow Structure</h3>
<p>Every YouTrack workflow rule follows this pattern:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">entities </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/entities</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">workflow </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/workflow</span><span>&#39;);
</span><span>
</span><span>exports.</span><span style="color:#bf616a;">rule </span><span>= </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Issue</span><span>.</span><span style="color:#96b5b4;">onChange</span><span>({
</span><span>  title: &#39;</span><span style="color:#a3be8c;">Rule_Name</span><span>&#39;,
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">guard</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#65737e;">// When should this rule execute?
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">isChanged</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>);
</span><span>  },
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">action</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#65737e;">// What should happen?
</span><span>    </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(</span><span style="color:#bf616a;">condition</span><span>, &#39;</span><span style="color:#a3be8c;">Error message</span><span>&#39;);
</span><span>  },
</span><span>  
</span><span>  requirements: {
</span><span>    </span><span style="color:#65737e;">// Define required fields and their types
</span><span>    State: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">fieldType</span><span>,
</span><span>      IP: { name: &#39;</span><span style="color:#a3be8c;">In Progress</span><span>&#39; }
</span><span>    }
</span><span>  }
</span><span>});
</span></code></pre>
<h3 id="key-components">Key Components</h3>
<p><strong>Guard</strong>: Determines when the rule executes. Typically checks if specific fields changed or reached certain values.</p>
<p><strong>Action</strong>: Contains the validation or automation logic. Uses <code>workflow.check()</code> to enforce rules.</p>
<p><strong>Requirements</strong>: Declares field dependencies and defines named constants for field values.</p>
<h2 id="example-1-validating-test-environment-deployments">Example 1: Validating Test Environment Deployments</h2>
<h3 id="the-problem">The Problem</h3>
<p>Our team uses semantic versioning with a special test pattern: <code>v0.0.0(BUILD_NUMBER)</code> for test/QA builds. When testers finish validating a test build, they might accidentally move it to "Production Ready" or "Done" instead of returning it to developers for code review and merging to the main branch.</p>
<h3 id="the-solution">The Solution</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">entities </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/entities</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">workflow </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/workflow</span><span>&#39;);
</span><span>
</span><span>exports.</span><span style="color:#bf616a;">rule </span><span>= </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Issue</span><span>.</span><span style="color:#96b5b4;">onChange</span><span>({
</span><span>  title: &#39;</span><span style="color:#a3be8c;">Testqa_should_be_code_review</span><span>&#39;,
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">guard</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#65737e;">// Pattern to match test QA versions: v0.0.0(123)
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">testQAVersion </span><span>= new RegExp(/</span><span style="color:#96b5b4;">v0\.0\.0\(</span><span style="color:#d08770;">\d</span><span>*</span><span style="color:#96b5b4;">\)</span><span>/, &#39;</span><span style="color:#a3be8c;">i</span><span>&#39;);
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">isTestQA </span><span>= </span><span style="color:#bf616a;">testQAVersion</span><span>.</span><span style="color:#96b5b4;">exec</span><span>(
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">oldValue</span><span>(</span><span style="color:#bf616a;">ctx</span><span>[&#39;</span><span style="color:#a3be8c;">Fix version</span><span>&#39;])
</span><span>    ) != </span><span style="color:#d08770;">null</span><span>;
</span><span>    
</span><span>    </span><span style="color:#65737e;">// Only execute when:
</span><span>    </span><span style="color:#65737e;">// 1. State changed
</span><span>    </span><span style="color:#65737e;">// 2. Moving to final states
</span><span>    </span><span style="color:#65737e;">// 3. Coming from QA (Staging)
</span><span>    </span><span style="color:#65737e;">// 4. Fix version is a test build
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">isChanged</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>) &amp;&amp; 
</span><span>    (
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">SR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">PR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">QAP</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">DONE</span><span>)
</span><span>    ) &amp;&amp;
</span><span>    </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">was</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">QAS</span><span>) &amp;&amp; 
</span><span>    </span><span style="color:#bf616a;">isTestQA</span><span>;
</span><span>  },
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">action</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>      </span><span style="color:#d08770;">false</span><span>,
</span><span>      &quot;</span><span style="color:#a3be8c;">It&#39;s TestQA task! After test, we should return it back to </span><span>&quot; +
</span><span>      &quot;</span><span style="color:#a3be8c;">developers for Code Review. For merging it to the &#39;Base&#39; branch!</span><span>&quot;
</span><span>    );
</span><span>  },
</span><span>  
</span><span>  requirements: {
</span><span>    State: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">fieldType</span><span>,
</span><span>      CR: { name: &#39;</span><span style="color:#a3be8c;">Code Review</span><span>&#39;},
</span><span>      DONE: { name: &#39;</span><span style="color:#a3be8c;">Done</span><span>&#39;},
</span><span>      PR: { name: &#39;</span><span style="color:#a3be8c;">Production Ready</span><span>&#39;},
</span><span>      SR: { name: &#39;</span><span style="color:#a3be8c;">Staging Ready</span><span>&#39;},
</span><span>      QAS: { name: &#39;</span><span style="color:#a3be8c;">QA (Staging)</span><span>&#39;},
</span><span>      QAP: { name: &#39;</span><span style="color:#a3be8c;">QA (Production)</span><span>&#39;},
</span><span>    },
</span><span>    &quot;</span><span style="color:#a3be8c;">Fix version</span><span>&quot;: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Field</span><span>.</span><span style="color:#bf616a;">stringType</span><span>,
</span><span>    }
</span><span>  }
</span><span>});
</span></code></pre>
<h3 id="how-it-works">How It Works</h3>
<ol>
<li><strong>Version Detection</strong>: Uses regex to identify test builds by version pattern</li>
<li><strong>State Validation</strong>: Checks if transitioning from QA to final states</li>
<li><strong>Error Prevention</strong>: Blocks the transition with a clear explanation</li>
<li><strong>User Guidance</strong>: Message explains the correct workflow</li>
</ol>
<h3 id="key-techniques">Key Techniques</h3>
<p><strong>Regex Pattern Matching</strong>: <code>new RegExp(/v0\.0\.0\(\d*\)/, 'i')</code> matches versions like <code>v0.0.0(42)</code></p>
<p><strong>Old Value Access</strong>: <code>ctx.issue.fields.oldValue(ctx['Fix version'])</code> checks the previous field value before the change</p>
<p><strong>Multiple State Checks</strong>: Combines several <code>becomes()</code> calls with OR logic to catch all problematic transitions</p>
<p><strong>Always False Check</strong>: <code>workflow.check(false, ...)</code> always prevents the transition, acting as a hard block</p>
<h2 id="example-2-enforcing-time-tracking">Example 2: Enforcing Time Tracking</h2>
<h3 id="the-problem-1">The Problem</h3>
<p>Developers often forget to log spent time before moving tasks forward. This causes inaccurate sprint reports and makes it difficult to estimate future work.</p>
<h3 id="the-solution-1">The Solution</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">entities </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/entities</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">dateTime </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/date-time</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">workflow </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/workflow</span><span>&#39;);
</span><span>
</span><span>exports.</span><span style="color:#bf616a;">rule </span><span>= </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Issue</span><span>.</span><span style="color:#96b5b4;">onChange</span><span>({
</span><span>  title: &#39;</span><span style="color:#a3be8c;">Check_spend_time</span><span>&#39;,
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">guard</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#65737e;">// Execute when moving to any of these states
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">isChanged</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>) &amp;&amp; (
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">CR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">DONE</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">PR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">SR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">QAS</span><span>)
</span><span>    );
</span><span>  },
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">action</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">spentTimeNull </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>[&quot;</span><span style="color:#a3be8c;">Spent Time</span><span>&quot;] === </span><span style="color:#d08770;">null</span><span>;
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">zeroTime </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">is</span><span>(
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>[&quot;</span><span style="color:#a3be8c;">Spent Time</span><span>&quot;], 
</span><span>      </span><span style="color:#bf616a;">dateTime</span><span>.</span><span style="color:#8fa1b3;">toPeriod</span><span>(</span><span style="color:#d08770;">0</span><span>)
</span><span>    );
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">isValidSpentTime </span><span>= !(</span><span style="color:#bf616a;">zeroTime </span><span>|| </span><span style="color:#bf616a;">spentTimeNull</span><span>);
</span><span>    
</span><span>    </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>      </span><span style="color:#bf616a;">isValidSpentTime</span><span>, 
</span><span>      </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">i18n</span><span>(&#39;</span><span style="color:#a3be8c;">Spent time is 0m, please update the value.</span><span>&#39;)
</span><span>    );
</span><span>  },
</span><span>  
</span><span>  requirements: {
</span><span>    State: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">fieldType</span><span>,
</span><span>      CR: { name: &#39;</span><span style="color:#a3be8c;">Code Review</span><span>&#39;},
</span><span>      DONE: { name: &#39;</span><span style="color:#a3be8c;">Done</span><span>&#39;},
</span><span>      PR: { name: &#39;</span><span style="color:#a3be8c;">Production Ready</span><span>&#39;},
</span><span>      SR: { name: &#39;</span><span style="color:#a3be8c;">Staging Ready</span><span>&#39;},
</span><span>      QAS: { name: &#39;</span><span style="color:#a3be8c;">QA (Staging)</span><span>&#39;},
</span><span>    },
</span><span>    &quot;</span><span style="color:#a3be8c;">Spent Time</span><span>&quot;: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Field</span><span>.</span><span style="color:#bf616a;">periodType
</span><span>    }
</span><span>  }
</span><span>});
</span></code></pre>
<h3 id="how-it-works-1">How It Works</h3>
<ol>
<li><strong>Trigger Points</strong>: Activates when moving to key workflow states</li>
<li><strong>Null Checks</strong>: Validates that "Spent Time" field exists and has a value</li>
<li><strong>Zero Detection</strong>: Checks if time is explicitly zero using <code>dateTime.toPeriod(0)</code></li>
<li><strong>Validation Logic</strong>: Combines both checks with negation</li>
<li><strong>User Feedback</strong>: Provides clear message about what needs to be fixed</li>
</ol>
<h3 id="key-techniques-1">Key Techniques</h3>
<p><strong>Period Type Handling</strong>: YouTrack stores time as period objects, requiring <code>dateTime.toPeriod()</code> for comparison</p>
<p><strong>Null Safety</strong>: Checks both <code>null</code> and zero separately since they represent different states</p>
<p><strong>Internationalization</strong>: Uses <code>workflow.i18n()</code> for translatable error messages</p>
<p><strong>Multi-State Triggering</strong>: Single rule covers multiple state transitions to avoid duplication</p>
<h2 id="example-3-enforcing-task-estimation">Example 3: Enforcing Task Estimation</h2>
<h3 id="the-problem-2">The Problem</h3>
<p>Tasks moved to "In Progress" without effort estimates make sprint planning impossible and burn-down charts unreliable.</p>
<h3 id="the-solution-2">The Solution</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">entities </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/entities</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">dateTime </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/date-time</span><span>&#39;);
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">workflow </span><span>= </span><span style="color:#96b5b4;">require</span><span>(&#39;</span><span style="color:#a3be8c;">@jetbrains/youtrack-scripting-api/workflow</span><span>&#39;);
</span><span>
</span><span>exports.</span><span style="color:#bf616a;">rule </span><span>= </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Issue</span><span>.</span><span style="color:#96b5b4;">onChange</span><span>({
</span><span>  title: &#39;</span><span style="color:#a3be8c;">Check_estimation</span><span>&#39;,
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">guard</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#65737e;">// Execute when entering work states
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">isChanged</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>) &amp;&amp; (
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">IP</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">CR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">DONE</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">PR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">SR</span><span>) ||
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">QAS</span><span>)
</span><span>    );
</span><span>  },
</span><span>  
</span><span>  </span><span style="color:#8fa1b3;">action</span><span>: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&quot;</span><span style="color:#a3be8c;">Check_estimation</span><span>&quot;);
</span><span>    
</span><span>    </span><span style="color:#65737e;">// Enforce required field
</span><span>    </span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Estimation </span><span>=== </span><span style="color:#d08770;">null</span><span>) {
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">required</span><span>(
</span><span>        </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">Estimation</span><span>, 
</span><span>        &#39;</span><span style="color:#a3be8c;">Set an estimation</span><span>&#39;
</span><span>      );
</span><span>    }
</span><span>    
</span><span>    </span><span style="color:#65737e;">// Check for zero estimation
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">zeroTime </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">is</span><span>(
</span><span>      </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">Estimation</span><span>, 
</span><span>      </span><span style="color:#bf616a;">dateTime</span><span>.</span><span style="color:#8fa1b3;">toPeriod</span><span>(</span><span style="color:#d08770;">0</span><span>)
</span><span>    );
</span><span>    
</span><span>    </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>      !</span><span style="color:#bf616a;">zeroTime</span><span>,
</span><span>      </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">i18n</span><span>(&#39;</span><span style="color:#a3be8c;">Estimation is 0m, please update the value.</span><span>&#39;)
</span><span>    );
</span><span>  },
</span><span>  
</span><span>  requirements: {
</span><span>    State: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">fieldType</span><span>,
</span><span>      IP: { name: &#39;</span><span style="color:#a3be8c;">In Progress</span><span>&#39; },
</span><span>      CR: { name: &#39;</span><span style="color:#a3be8c;">Code Review</span><span>&#39;},
</span><span>      DONE: { name: &#39;</span><span style="color:#a3be8c;">Done</span><span>&#39;},
</span><span>      PR: { name: &#39;</span><span style="color:#a3be8c;">Production Ready</span><span>&#39;},
</span><span>      SR: { name: &#39;</span><span style="color:#a3be8c;">Staging Ready</span><span>&#39;},
</span><span>      QAS: { name: &#39;</span><span style="color:#a3be8c;">QA (Staging)</span><span>&#39;},
</span><span>    },
</span><span>    Estimation: {
</span><span>      type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Field</span><span>.</span><span style="color:#bf616a;">periodType
</span><span>    }
</span><span>  }
</span><span>});
</span></code></pre>
<h3 id="how-it-works-2">How It Works</h3>
<ol>
<li><strong>Early Validation</strong>: Checks when entering "In Progress" and subsequent states</li>
<li><strong>Required Field</strong>: Uses <code>ctx.issue.fields.required()</code> to mark field as mandatory</li>
<li><strong>Zero Check</strong>: Validates that estimation isn't just set, but has a meaningful value</li>
<li><strong>Debug Logging</strong>: Includes <code>console.log()</code> for troubleshooting in YouTrack's workflow console</li>
</ol>
<h3 id="key-techniques-2">Key Techniques</h3>
<p><strong>Required Field API</strong>: <code>ctx.issue.fields.required(field, message)</code> forces field population before allowing the transition</p>
<p><strong>Dual Validation</strong>: Checks both null and zero conditions separately with different error messages</p>
<p><strong>Progressive States</strong>: Triggers on "In Progress" ensures estimates are set early in the workflow</p>
<p><strong>Console Logging</strong>: <code>console.log()</code> helps debug workflow execution in YouTrack's admin interface</p>
<h2 id="advanced-patterns">Advanced Patterns</h2>
<h3 id="combining-multiple-conditions">Combining Multiple Conditions</h3>
<p>You can chain multiple validations in a single rule:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#65737e;">// Check multiple conditions
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">hasEstimation </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Estimation </span><span>!== </span><span style="color:#d08770;">null</span><span>;
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">hasSpentTime </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>[&quot;</span><span style="color:#a3be8c;">Spent Time</span><span>&quot;] !== </span><span style="color:#d08770;">null</span><span>;
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">hasAssignee </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Assignee </span><span>!== </span><span style="color:#d08770;">null</span><span>;
</span><span>  
</span><span>  </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>    </span><span style="color:#bf616a;">hasEstimation </span><span>&amp;&amp; </span><span style="color:#bf616a;">hasSpentTime </span><span>&amp;&amp; </span><span style="color:#bf616a;">hasAssignee</span><span>,
</span><span>    &#39;</span><span style="color:#a3be8c;">Task must have estimation, spent time, and assignee before closing</span><span>&#39;
</span><span>  );
</span><span>}
</span></code></pre>
<h3 id="using-field-old-values">Using Field Old Values</h3>
<p>Compare current and previous values to detect specific changes:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>guard: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">oldPriority </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">oldValue</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">Priority</span><span>);
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">newPriority </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Priority</span><span>;
</span><span>  
</span><span>  </span><span style="color:#65737e;">// Trigger only when priority increases
</span><span>  </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">oldPriority </span><span>&amp;&amp; </span><span style="color:#bf616a;">newPriority </span><span>&amp;&amp; 
</span><span>         </span><span style="color:#bf616a;">newPriority</span><span>.</span><span style="color:#bf616a;">ordinal </span><span>&gt; </span><span style="color:#bf616a;">oldPriority</span><span>.</span><span style="color:#bf616a;">ordinal</span><span>;
</span><span>}
</span></code></pre>
<h3 id="custom-error-messages">Custom Error Messages</h3>
<p>Build dynamic error messages based on context:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">estimation </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Estimation</span><span>;
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">spentTime </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>[&quot;</span><span style="color:#a3be8c;">Spent Time</span><span>&quot;];
</span><span>  
</span><span>  </span><span style="color:#b48ead;">if </span><span>(</span><span style="color:#bf616a;">spentTime </span><span>&gt; </span><span style="color:#bf616a;">estimation </span><span>* </span><span style="color:#d08770;">2</span><span>) {
</span><span>    </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>      </span><span style="color:#d08770;">false</span><span>,
</span><span>      `</span><span style="color:#a3be8c;">Spent time (${</span><span style="color:#bf616a;">spentTime</span><span style="color:#a3be8c;">}) is more than 2x estimation (${</span><span style="color:#bf616a;">estimation</span><span style="color:#a3be8c;">}). </span><span>` +
</span><span>      &#39;</span><span style="color:#a3be8c;">Please update the estimation or add a comment explaining the overrun.</span><span>&#39;
</span><span>    );
</span><span>  }
</span><span>}
</span></code></pre>
<h3 id="accessing-issue-context">Accessing Issue Context</h3>
<p>YouTrack provides rich context information:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">assignee </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Assignee</span><span>;
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">reporter </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">reporter</span><span>;
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">currentUser </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">currentUser</span><span>;
</span><span>  
</span><span>  </span><span style="color:#65737e;">// Only assignee or reporter can close the task
</span><span>  </span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>    </span><span style="color:#bf616a;">currentUser </span><span>=== </span><span style="color:#bf616a;">assignee </span><span>|| </span><span style="color:#bf616a;">currentUser </span><span>=== </span><span style="color:#bf616a;">reporter</span><span>,
</span><span>    &#39;</span><span style="color:#a3be8c;">Only the assignee or reporter can close this task</span><span>&#39;
</span><span>  );
</span><span>}
</span></code></pre>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-keep-guards-specific">1. Keep Guards Specific</h3>
<p>Write narrow guards that trigger only when necessary:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Good: Specific trigger
</span><span>guard: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">isChanged</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>) &amp;&amp;
</span><span>         </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">DONE</span><span>);
</span><span>}
</span><span>
</span><span style="color:#65737e;">// Bad: Too broad
</span><span>guard: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">return </span><span style="color:#d08770;">true</span><span>; </span><span style="color:#65737e;">// Executes on every change!
</span><span>}
</span></code></pre>
<h3 id="2-provide-clear-error-messages">2. Provide Clear Error Messages</h3>
<p>Users should understand exactly what's wrong and how to fix it:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Good: Specific and actionable
</span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(
</span><span>  </span><span style="color:#bf616a;">hasEstimation</span><span>,
</span><span>  &#39;</span><span style="color:#a3be8c;">Please set an estimation before moving to In Progress. </span><span>&#39; +
</span><span>  &#39;</span><span style="color:#a3be8c;">Click the Estimation field and enter the expected time.</span><span>&#39;
</span><span>);
</span><span>
</span><span style="color:#65737e;">// Bad: Vague
</span><span style="color:#bf616a;">workflow</span><span>.</span><span style="color:#8fa1b3;">check</span><span>(</span><span style="color:#bf616a;">hasEstimation</span><span>, &#39;</span><span style="color:#a3be8c;">Invalid</span><span>&#39;);
</span></code></pre>
<h3 id="3-use-console-logging-for-debugging">3. Use Console Logging for Debugging</h3>
<p>Add strategic logging to understand workflow execution:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&#39;</span><span style="color:#a3be8c;">Current state:</span><span>&#39;, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">State</span><span>.name);
</span><span>  </span><span style="color:#ebcb8b;">console</span><span>.</span><span style="color:#96b5b4;">log</span><span>(&#39;</span><span style="color:#a3be8c;">Assignee:</span><span>&#39;, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Assignee</span><span>?.</span><span style="color:#bf616a;">login</span><span>);
</span><span>  
</span><span>  </span><span style="color:#65737e;">// ... validation logic
</span><span>}
</span></code></pre>
<p>View logs in YouTrack: <strong>Administration  Workflows  [Your Workflow]  Logs</strong></p>
<h3 id="4-define-all-required-states">4. Define All Required States</h3>
<p>Explicitly list all states in requirements to avoid runtime errors:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span>requirements: {
</span><span>  State: {
</span><span>    type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">fieldType</span><span>,
</span><span>    </span><span style="color:#65737e;">// Define every state you reference
</span><span>    NEW: { name: &#39;</span><span style="color:#a3be8c;">New</span><span>&#39; },
</span><span>    IP: { name: &#39;</span><span style="color:#a3be8c;">In Progress</span><span>&#39; },
</span><span>    CR: { name: &#39;</span><span style="color:#a3be8c;">Code Review</span><span>&#39; },
</span><span>    DONE: { name: &#39;</span><span style="color:#a3be8c;">Done</span><span>&#39; }
</span><span>  }
</span><span>}
</span></code></pre>
<h3 id="5-test-thoroughly">5. Test Thoroughly</h3>
<p>Create test scenarios covering:</p>
<ul>
<li> Valid transitions (should succeed)</li>
<li> Invalid transitions (should be blocked)</li>
<li> Edge cases (null values, zero times, etc.)</li>
<li> Multiple field changes simultaneously</li>
</ul>
<h2 id="deployment-strategy">Deployment Strategy</h2>
<h3 id="development-workflow">Development Workflow</h3>
<ol>
<li><strong>Create draft workflow</strong> in YouTrack Administration</li>
<li><strong>Attach to test project</strong> first, not production</li>
<li><strong>Test thoroughly</strong> with sample issues</li>
<li><strong>Review logs</strong> for errors or unexpected behavior</li>
<li><strong>Attach to production</strong> projects after validation</li>
</ol>
<h3 id="version-control">Version Control</h3>
<p>Store workflow code in your repository:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">project/
</span><span style="color:#bf616a;"></span><span> .youtrack/
</span><span style="color:#bf616a;"></span><span>    workflows/
</span><span style="color:#bf616a;"></span><span>       check-estimation.js
</span><span style="color:#bf616a;"></span><span>       check-spent-time.js
</span><span style="color:#bf616a;"></span><span>       validate-testqa.js
</span><span style="color:#bf616a;"></span><span>    README.md
</span></code></pre>
<p>Document each workflow's purpose and requirements in the README.</p>
<h3 id="monitoring">Monitoring</h3>
<p>Regularly check workflow logs for:</p>
<ul>
<li><strong>Unexpected errors</strong>: JavaScript exceptions</li>
<li><strong>Performance issues</strong>: Slow execution times</li>
<li><strong>User confusion</strong>: Patterns of blocked transitions</li>
</ul>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<h3 id="1-forgetting-to-define-requirements">1. Forgetting to Define Requirements</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Error: ctx.State is undefined
</span><span>guard: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#8fa1b3;">becomes</span><span>(</span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>, </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">DONE</span><span>);
</span><span>}
</span><span>
</span><span style="color:#65737e;">// Missing requirements section!
</span></code></pre>
<p><strong>Fix</strong>: Always include complete requirements.</p>
<h3 id="2-incorrect-field-type">2. Incorrect Field Type</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Error: Type mismatch
</span><span>requirements: {
</span><span>  Estimation: {
</span><span>    type: </span><span style="color:#bf616a;">entities</span><span>.</span><span style="color:#bf616a;">Field</span><span>.</span><span style="color:#bf616a;">stringType </span><span style="color:#65737e;">// Wrong!
</span><span>  }
</span><span>}
</span></code></pre>
<p><strong>Fix</strong>: Use <code>entities.Field.periodType</code> for time fields.</p>
<h3 id="3-null-reference-errors">3. Null Reference Errors</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Error: Cannot read property &#39;name&#39; of null
</span><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">assignee </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Assignee</span><span>.name; </span><span style="color:#65737e;">// Might be null!
</span><span>}
</span></code></pre>
<p><strong>Fix</strong>: Use optional chaining or null checks:</p>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">assignee </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">Assignee</span><span>?.name ?? &#39;</span><span style="color:#a3be8c;">Unassigned</span><span>&#39;;
</span></code></pre>
<h3 id="4-infinite-loops">4. Infinite Loops</h3>
<pre data-lang="javascript" style="background-color:#2b303b;color:#c0c5ce;" class="language-javascript "><code class="language-javascript" data-lang="javascript"><span style="color:#65737e;">// Dangerous: Modifying fields in onChange can trigger recursion
</span><span>action: (</span><span style="color:#bf616a;">ctx</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>  </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">issue</span><span>.</span><span style="color:#bf616a;">fields</span><span>.</span><span style="color:#bf616a;">State </span><span>= </span><span style="color:#bf616a;">ctx</span><span>.</span><span style="color:#bf616a;">State</span><span>.</span><span style="color:#bf616a;">IP</span><span>; </span><span style="color:#65737e;">// Triggers onChange again!
</span><span>}
</span></code></pre>
<p><strong>Fix</strong>: Use guards carefully or consider using schedule rules instead of onChange.</p>
<h2 id="real-world-impact">Real-World Impact</h2>
<p>After implementing these three workflows in our team:</p>
<ul>
<li><strong>Time tracking compliance</strong>: Increased from 60% to 95%</li>
<li><strong>Estimation accuracy</strong>: Improved by 30% (fewer zero estimates)</li>
<li><strong>Production incidents</strong>: Reduced by 40% (fewer test builds deployed to prod)</li>
<li><strong>Code review coverage</strong>: Increased from 80% to 98%</li>
</ul>
<p>The key is enforcing policies at the moment of action, not during retrospectives.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://www.jetbrains.com/help/youtrack/devportal/api-entities.html">YouTrack Workflow JavaScript API</a></li>
<li><a href="https://www.jetbrains.com/help/youtrack/incloud/Quick-Start-Guide-Workflows-JS.html">Workflow Quick Start Guide</a></li>
<li><a href="https://www.jetbrains.com/help/youtrack/devportal/workflow-api.html">Scripting API Reference</a></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>YouTrack's JavaScript workflow engine provides powerful automation capabilities that go far beyond simple state machines. By implementing validation rules that execute at the moment of change, you can enforce project policies consistently across your team.</p>
<p>The three patterns explored hereversion validation, time tracking enforcement, and estimation requirementsdemonstrate how workflows can solve real development process problems. The key principles apply broadly:</p>
<ul>
<li><strong>Guard carefully</strong>: Only trigger when necessary</li>
<li><strong>Validate explicitly</strong>: Check all edge cases</li>
<li><strong>Message clearly</strong>: Help users understand what went wrong</li>
<li><strong>Test thoroughly</strong>: Verify both success and failure paths</li>
</ul>
<p>Whether you're managing a small team or a large organization, workflow automation ensures your processes are followed consistently, freeing your team to focus on building great software rather than remembering procedural rules.</p>
<p>Happy automating! </p>

        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Thanks for reading! Read other posts?</span>
                    <hr />
                </div>
                <div class="pagination__buttons">
                        <span class="button previous">
                            <a href="https://bimawa.github.io/blog/ios-strings-sync/">
                                <span class="button__icon"></span>&nbsp;
                                <span class="button__text">Building a Localization Sync Tool for iOS&#x2F;macOS</span>
                            </a>
                        </span>
                    
                    </div>
            </div>
        
    </div>

    </div>

    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright copyright--user">IP Bunkov Maksim Vladislavovich (Bimawa) &nbsp;<b>copyright</b></div>
            </div>
    </footer>
    

</div>
</body>

</html>
